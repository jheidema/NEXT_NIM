%%\documentclass[review]{elsarticle}
%\documentclass[preprint,3p,twocolumn]{elsarticle}
%\usepackage{lineno,hyperref}
%\usepackage{color}
%\usepackage{amsmath}
%\modulolinenumbers[10]
%
%\journal{NIMA}
%
%%%%%%%%%%%%%%%%%%%%%%%%
%%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%%
%%% To change the style, put a % in front of the second line of the current style and
%%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%%
%
%%% `Elsevier LaTeX' style
%\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%%
%
%\begin{document}
%
%\begin{frontmatter}
%
%\title{DRAFT: NEXT\emph{sim}: Simulating a neutron detector with tracking capabilities}
%%\tnotetext[mytitlenote]{Fully documented templates are available in the elsarticle package on \href{http://www.ctan.org/tex-archive/macros/latex/contrib/elsarticle}{CTAN}.}
%
%
%%% Group authors per affiliation:
%\author[mymainaddress]{D. P\'erez-Loureiro}
%\ead{dperezlo@utk.edu}
%
%
%\author[mymainaddress]{K. Schmitt\fnref{now}}
%\fntext[now]{Present address: Los Alamos National Laboratory, Los Alamos, New Mexico 87545, USA}
%
%
%%\author[otheraddress]{Others}
%
%
%\address[mymainaddress]{Department of Physics and Astronomy,  University of Tennessee, Knoxville, Tennessee , 37996 USA}
%%\address[otheraddress]{Others' Addresses}
%
%
%%% abstract
%\begin{abstract}
%The NEXT detector  resolution neutron detector array based on time of flight
%measurements. It will be composed of small modules of neutron-discriminating plastic scintillator
%coupled to silicon photomultipliers (SiPMs) for the readout.
%\end{abstract}
%
%\begin{keyword}
%$\beta$-delayed neutron emission
%\end{keyword}
%
%\end{frontmatter}
%
%
%\linenumbers


\section{Simulations: NEXT\emph{sim}}

In order to investigate the light collection efficiency as well as the timing capabilites of the different considered geometries, \emph{NEXTsim}, a {\sc Geant4}-based code was developed \cite{AGOSTINELLI2003250,ALLISON2016186}. This code uses  {\sc Geant4} version 10.1 Patch 3 and {\sc Root} files for the output.

\begin{figure*}[hbt]
\centering
\includegraphics[width=0.9\textwidth]{Figures/Geometries.eps}
\caption{Visualization of a 1 Mev neutron event in NEXT\emph{sim} for the three  geometries considered for NEXT. Green lines correspond to optical photons produced in the sctintillation.}
\label{fig:Geometries}
\end{figure*} 

This software simulates the interaction of neutrons, gammas, and charged particles in the matter they traverse. The  physics model (referred as \emph{Physics List} in the {\sc Geant4} context) employed is the recommended QGS\_BERT\_HP, which includes the standard electromagnetic, and the high precision models for neutron scattering, elastic and inelastic, as well as capture and fission.  This model is based on the G4NDL evaluated neutron data library \cite{Apostolakis2009}. I addition to this physics list, the G4OpticalPhysicsList is included to treat the transport of scintillation light as well as the G4RadioactiveDecay to simulate radioactive sources. The generation of the primary particles  was made with the GeneralParticleSource (GPS) module, which allows to define complex beam profiles or source geometries. This module allows to define the primary particle,  spacial and angular distribution, as well as the kinetic energy with simple commands.
 
 All the different geometries considered for the NEXT modules were modeled and simulated (see  Fig.~\ref{fig:Geometries}): hexagons, scintillator bars and elliptical (bars in which the corners were cut in angle to maximize the light focusing in the detector). The user can select between any of the geometries, scintillator, and wrapping materials, as well as the type of photosensor (SiPM or PMT) via macro-driven commands. 

For every event, the simulation tracks the incoming particle and registers each interaction in the different layers of matter and stores the information in a \emph{ScintHit} object, which includes position, time and momentum. The collection of hits of each event is stored in a  {\sc Root} \emph{TClonesArray} and then saved in a \emph{Tree}.

\begin{figure}[hbt]
\centering
\includegraphics[width=0.48\textwidth]{Figures/LightCollectionEfficiency.eps}
\caption{Scatter plot of the simulation  light collection efficiency as a function of the deposited energy by 1 MeV neutrons for the tree geometries considered for NEXT modules.}
\label{fig:Efficiency}
\end{figure}

In addition, the code is also able to simulate the scintillation process induced by the scattered particles in it. All the optical photons produced are then tracked until they are detected or absorbed. For each detected photon, their positions and arrival times are recorded in  a \emph{OptPhotonHit} and the hit collection is saved in the same  \emph{Tree} as the emph{ScintHits}.

\subsection{Simulation of light collection efficency}

The three different geometries considered for the NEXT detector were simulated in order to determine the light collection efficiency. Figure \ref{fig:Efficiency} shows the results of the light collection efficiency, calculated as the ratio between detected and produced photons, as a function of the energy deposited in the scintillator. In this case the photosensors are considered ideal and every photon hitting the sensitive surface will be detected. We observe that the hexagonal and the rectangular geometries have efficiencies close to 50\% on average. The efficiency of the elliptical shape is higher and it reaches up to 68\% due to the focusing effect towards the photosensors.


\subsubsection{Study of neutron backscattering}
Investigating neutron back scattering is very important in a multi-layered detector like NEXT. If a neutron is backscattered to a previous layer this may lead to a wrong determination  of the neutron kinetic energy 

We employed the \emph{NEXTsim} code to evaluate the probability of backscattering in different layers of the detector after 2, 3 and 4 scattering events in the detectors for neutron energies between 100~keV and 5~MeV. The simulation tracks the neutron while traversing the detector layers and we count a backscattering event if the difference between the final and initial layers is negative. Figure  \ref{fig:backscattering} shows the result of the position difference in layers obtained the simulation for a 2~MeV neutron pencil beam. We observe that the probability of backscattering is lower than 5\% after a single scatter. This probability is below 12\% even after several scatters. Figure  

\begin{figure}[htb]
\centering
\includegraphics[width=0.48\textwidth]{Figures/Backscattering2MeV_NEXT.eps}
\caption{Layer difference between the second (blue) and last (red) scattering events within the NEXT detector for a 2 MeV incident neutron.}
\label{fig:backscattering}
\end{figure}



\subsection{Simulation of photosensor response}
The signals produced by the scintillation light in the detectors were  also added  to the simulations. The Single Photo Electron (SPE) response function of the photosensors were modeled and then folded with the optical photon distribution to obtain a realistic signal. The SPE functions for SiPMs and PMTs were  taken from the  Refs. \cite{,Choong2009} respectively. 


\subsection{Simulation of position resolution of the detector}


\subsection{Simulation of time of flight resolution of the detector}
We have simulated the time of flight spectrum of 1~MeV neutrons impinging onto 10-cm-long plastic scintillator bars in order to determine their timing resolution

\begin{figure}[htb]
\centering
\includegraphics[width=0.48\textwidth]{Figures/ToF.eps}
\caption{Distribution of the time of flight for a pencil beam  placed 20 cm away from the detector of 1MeV  neutrons impinging onto different thicknesses scintillators.}
\label{fig:ToF}
\end{figure}



%\section{Conclusions}

%%HERE the BIBLIOGRAPHY
%\section*{References}
%%\nocite{*}
%%\bibliography{mybibfile}
%\bibliography{NEXT_NIM}
%
%\end{document}




